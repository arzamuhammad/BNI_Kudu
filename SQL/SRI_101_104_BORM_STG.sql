DROP TABLE IF EXISTS default.SRI_101_104_BORM_STG;


CREATE EXTERNAL TABLE default.SRI_101_104_BORM_STG
     (
      KEY_1 STRING,
      BORVST STRING,
      NO_TRN STRING,
      NO_PER_TRN STRING,
      REC_NO STRING,
      NO_NON_FIN STRING,
      SYS STRING,
      BR_NO STRING,
      STAT STRING,
      ACT_TYPE STRING,
      INT_REST STRING,
      BORR_TYPE STRING,
      ADD_LOAN_STAT STRING,
      DISCH_REFERENCE STRING,
      FCC_CLUS STRING,
      REGISTRY_CODE STRING,
      SECURITY_METHOD STRING,
      SEC_ACCESS_IND STRING,
      DISCH_FEE_CODE STRING,
      INT_REPAY_FREQ STRING,
      PURPOSE_CODE_A SMALLINT,
      TOM_RATE_TBL_ID STRING,
      LOAN_OFFICER INTEGER,
      PREVIOUS_OFFICER SMALLINT,
      REFERRAL_FLAG SMALLINT,
      REFERRAL_DATE DATE,
      APPLIC_ISSUE_DATE DATE,
      APPLIC_AMOUNT DECIMAL(22,0),
      INT_REPAY_DAY STRING,
      VALUER_CODE STRING,
      REPAY_COUNT SMALLINT,
      REPAY_IN_AFFECT STRING,
      NO_OF_OWNER SMALLINT,
      NO_OF_MESSAGES SMALLINT,
      REPAY_DAY SMALLINT,
      REPAY_FREQ SMALLINT,
      EOY_BASIC_BAL DECIMAL(22,3),
      PEND_RATE DECIMAL(8,4),
      APP_AMT DECIMAL(22,3),
      LOAN_BAL DECIMAL(18,3),
      UNC_VAL DECIMAL(22,3),
      ADV_VAL DECIMAL(22,3),
      NPB_VAL DECIMAL(22,3),
      THEO_LOAN_BAL DECIMAL(18,3),
      INTEREST DECIMAL(22,3),
      SOP_BAL DECIMAL(22,3),
      SOP_THEO_BAL DECIMAL(22,3),
      DUE_AMT DECIMAL(22,3),
      LOAN_REPAY DECIMAL(22,3),
      PEND_DUES DECIMAL(22,3),
      EOM_THEO_BAL DECIMAL(22,3),
      EOM_BASIC_BAL DECIMAL(22,3),
      ADD_LOAN_APP DECIMAL(22,3),
      ADD_LOAN_ADV DECIMAL(22,3),
      ADD_DUES DECIMAL(22,3),
      GROUPS STRING,
      SUB_GROUP STRING,
      APPRV_DATE DATE,
      LST_FIN_DATE DATE,
      LST_MNT_DATE DATE,
      ADV_DATE DATE,
      DUE_STRT_DATE DATE,
      ADD_DUES_STRT_DATE DATE,
      LST_ARR_DATE DATE,
      PEND_DUES_DATE DATE,
      INT_STRT_DATE DATE,
      REPAY_TYPE INTEGER,
      PAY_DAY SMALLINT,
      RENEWAL_DATE DATE,
      ATM_FLAG STRING,
      INT_RATE DECIMAL(7,4),
      ADD_ADV_DATE DATE,
      ADD_APPRV_DATE DATE,
      BACK_DT_IND STRING,
      CAT STRING,
      STOP_IND SMALLINT,
      HOLD_IND SMALLINT,
      NO_UNC SMALLINT,
      NO_NPB INTEGER,
      THEO_UNPD_TOM_INT DECIMAL(10,5),
      LOAN_TRM SMALLINT,
      REM_REPAYS SMALLINT,
      DISCH_MTHS SMALLINT,
      MISC_DR_01 DECIMAL(9,3),
      TRN_CODE_01 SMALLINT,
      LEDG_CODE_01 STRING,
      SUB_LEDG_01 STRING,
      MISC_DR_02 DECIMAL(9,3),
      TRN_CODE_02 SMALLINT,
      LEDG_CODE_02 STRING,
      SUB_LEDG_02 STRING,
      MISC_DR_03 DECIMAL(9,3),
      TRN_CODE_03 SMALLINT,
      LEDG_CODE_03 STRING,
      SUB_LEDG_03 STRING,
      SEGMENT_CODE STRING,
      CONST_CDE STRING,
      SOLICITOR_CDE STRING,
      COUNCIL_CDE STRING,
      SEC_LESD_CDE STRING,
      INT_CDE STRING,
      FINE_CDE STRING,
      MPI_CDE STRING,
      MORTGAGE_INSU STRING,
      SPL_LOAN_CDE STRING,
      RATIO_VAL_CDE STRING,
      REASON_ARR_CDE STRING,
      ADD_LOAN_CDE STRING,
      SOURCE_CDE STRING,
      INT_FLAG STRING,
      LOANSAVER_IND STRING,
      LOC_IND STRING,
      SHRE_CAP_IND STRING,
      INS_IND STRING,
      INT_REST_EOFY STRING,
      BAD_DEBT_IND STRING,
      STOP_TRAN_IND STRING,
      REDRAW_IND STRING,
      SWEEP_ACCT_FLAG STRING,
      RESIDUAL_IND STRING,
      CSLD_STMT_PROS STRING,
      INTRO_BROKER_INDIC STRING,
      INT_ACCR DECIMAL(17,5),
      INT_INCR DECIMAL(17,5),
      BPI_ACCR DECIMAL(10,5),
      BPI_INCR DECIMAL(10,5),
      CI_ACCR DECIMAL(10,5),
      CI_INCR DECIMAL(17,5),
      ARR_INT_ACCR DECIMAL(17,5),
      ARR_INT_INCR DECIMAL(17,5),
      ARR_NOT_FLAG SMALLINT,
      STAMPED_AMT DECIMAL(10,5),
      REPAY_CAP_PERC STRING,
      REPAY_SCHED STRING,
      CAPN_METHOD STRING,
      FIXED_RT_DATE DATE,
      INST_NOT_DAYS INTEGER,
      INT_CONC INTEGER,
      INT_CONC_MOV INTEGER,
      INT_CONC_MOV_AD INTEGER,
      MSGS_PENDING SMALLINT,
      SEVERITY_COUNT SMALLINT,
      RT_INCR DECIMAL(10,5),
      RT_INCR_MOV INTEGER,
      RT_INCR_MOV_AD INTEGER,
      PRINC_REDUCT_EFF BIGINT,
      CUSTOMER_NO STRING,
      PRINC_REDUCT_PEND INTEGER,
      OLDEST_BDATE_DATE DATE,
      ADV_TOM_RATE DECIMAL(16,6),
      MAN_APP_CREDIT BIGINT,
      CURRENCY_IND STRING,
      ENDOW_EXP_DT DATE,
      STMT_PAGE_NO SMALLINT,
      CROSS_BORDER_RISK STRING,
      SECURITY_IND STRING,
      TIME_BAND STRING,
      REPAY_METHOD STRING,
      INT_TAX_YTD BIGINT,
      STORE_RATE DECIMAL(7,4),
      GRACE_EXP_DT INTEGER,
      UNEARNED_INT INTEGER,
      RESIDUAL_BAL BIGINT,
      LAST_BORV_46_DATE DATE,
      CR_RATING SMALLINT,
      CAFM_TYPE STRING,
      DUES_RECALC_IND STRING,
      BASM_RECALC_IND STRING,
      PDCC_VAL INTEGER,
      STMT_FREQUENCY STRING,
      STMT_CYCLE STRING,
      STMT_DAY STRING,
      POSTING_MASK STRING,
      REPORT_MASK STRING,
      STMT_DATE_IND STRING,
      LAST_STMT_DATE DATE,
      INT_ADJUSTMENT BIGINT,
      ARR_INT_ADJUSTMENT INTEGER,
      GL_CLASS_CODE STRING,
      STMT_COPIES STRING,
      INT_CODE STRING,
      TRF_ACCT_NO BIGINT,
      LAST_ACCT_TYPE_CHG INTEGER,
      UNCL_NO_INT_VAL INTEGER,
      TERM_BASIS STRING,
      ARR_ACCR_AMT DECIMAL(17,5),
      FD_IND STRING,
      IR_IND STRING,
      IP_IND STRING,
      CAP_UNPD_INT DECIMAL(18,3),
      CAP_THEO_UNPD_INT DECIMAL(18,3),
      UNPD_ARRS_INT_BAL DECIMAL(18,3),
      THEO_UNPD_ARRS_INT DECIMAL(18,3),
      UNPD_CHRG_BAL DECIMAL(18,3),
      THEO_UNPD_CHRG_BAL DECIMAL(18,3),
      UNPD_PRIN_BAL DECIMAL(18,3),
      THEO_UNPD_PRIN_BAL DECIMAL(18,3),
      NON_PERF_BAL DECIMAL(10,5),
      TOM_ACRU_AMT DECIMAL(10,5),
      UNPAID_TOM_INT DECIMAL(10,5),
      POOL_ID STRING,
      POOL_DEPOSIT_DATE DATE,
      CHR_EXEM_PROFILE STRING,
      CHR_CNT_01 SMALLINT,
      CHR_VAL_01 DECIMAL(10,3),
      CHR_CNT_02 SMALLINT,
      CHR_VAL_02 DECIMAL(10,3),
      CHR_CNT_03 SMALLINT,
      CHR_VAL_03 DECIMAL(10,3),
      CHR_CNT_04 SMALLINT,
      CHR_VAL_04 DECIMAL(10,3),
      CHR_CNT_05 SMALLINT,
      CHR_VAL_05 DECIMAL(10,3),
      CHR_CNT_06 SMALLINT,
      CHR_VAL_06 DECIMAL(10,3),
      CHR_CNT_07 SMALLINT,
      CHR_VAL_07 DECIMAL(10,3),
      CHR_CNT_08 SMALLINT,
      CHR_VAL_08 DECIMAL(10,3),
      CHR_CNT_09 SMALLINT,
      CHR_VAL_09 DECIMAL(10,3),
      CHR_CNT_10 SMALLINT,
      CHR_VAL_10 DECIMAL(10,3),
      BK1008_AGREEMENT_1 INTEGER,
      BK1008_AGREEMENT_2 INTEGER,
      BK1005_PARTY_1 INTEGER,
      BK1005_PARTY_2 INTEGER,
      BK1005_PARTY_3 INTEGER,
      BK1009_PRODUCT_1 INTEGER,
      BK1000_COA_1 INTEGER,
      BK1001_COA_SEG_1 INTEGER,
      BK1001_COA_SEG_2 INTEGER,
      BK1001_COA_SEG_3 INTEGER,
      BK1001_COA_SEG_4 INTEGER,
      Start_Ts TIMESTAMP,
      End_Ts TIMESTAMP,
      Start_Date DATE,
      End_Date DATE,
      Record_Deleted_Flag SMALLINT ,
      Ctl_Id SMALLINT,
      File_Id SMALLINT,
      Process_Name STRING,
      Process_Id INTEGER,
      Update_Process_Name STRING,
      Update_Process_Id INTEGER
      )
      ROW FORMAT DELIMITED
      FIELDS TERMINATED BY ';'
      STORED AS TEXTFILE
      LOCATION 's3a://mardiyan-aws-2201-bucket/data/tmp/bni/SRI_101_104_BORM/'
      TBLPROPERTIES ('skip.header.line.count'='1');